// Generated by CoffeeScript 1.4.0
var $;

$ = jQuery;

$.fn.extend({
  validate: function(options) {
    var log, settings;
    settings = {
      debug: false,
      onKeyupValidationSuccess: function(elem, valrule) {},
      onKeyupValidationError: function(elem, valrule) {},
      onFocusOutValidationSuccess: function(elem, valrule) {},
      onFocusOutValidationError: function(elem, valrule) {},
      valrules: {
        fullname: {
          valfun: function(str) {
            var exp;
            exp = /^[a-zA-ZÖÜÄßöüäøñ]{2,}(\s[a-zA-ZÖÜÄßöüäøñ]{2,}){1,3}$/;
            if (str.match(exp) !== null) {
              return true;
            } else {
              return false;
            }
          },
          successmsg: 'We got a full name! Awesome!',
          errormsg: 'You have to provide a full name, asshole!'
        }
      }
    };
    settings = $.extend(settings, options);
    log = function(msg) {
      if (settings.debug) {
        return typeof console !== "undefined" && console !== null ? console.log(msg) : void 0;
      }
    };
    return this.each(function() {
      var watchForm;
      watchForm = function(elem) {
        var minval, valrule;
        if (!elem.is('select')) {
          valrule = settings.valrules[elem.data('valrule')];
          minval = elem.data('minval');
          if (valrule != null) {
            return elem.on('keyup', function(e) {
              if (e.which === 13) {
                return e.preventDefault();
              } else {
                if (minval != null) {
                  if (elem.val().length >= parseInt(minval)) {
                    if (valrule.valfun(elem.val())) {
                      settings.onKeyupValidationSuccess(elem, valrule);
                      return console.log('success triggered');
                    } else {
                      settings.onKeyupValidationError(elem, valrule);
                      return console.log('error triggered');
                    }
                  }
                } else {
                  if (valrule.valfun(elem.val())) {
                    return settings.onKeyupValidationSuccess(elem, valrule);
                  } else {
                    return settings.onKeyupValidationError(elem, valrule);
                  }
                }
              }
            });
          }
        }
      };
      log("Preparing magic show.");
      return $(this).find('input, select, textarea').each(function(i) {
        return watchForm($(this));
      });
    });
  }
});
